"use strict";var l=exports&&exports.__classPrivateFieldSet||function(i,t,e,r,n){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?i!==t||!n:!t.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?n.call(i,e):n?n.value=e:t.set(i,e),e},d=exports&&exports.__classPrivateFieldGet||function(i,t,e,r){if(e==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?i!==t||!r:!t.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?r:e==="a"?r.call(i):r?r.value:t.get(i)},o;Object.defineProperty(exports,"__esModule",{value:!0});exports.EncryptionService=void 0;var c=require("crypto"),h="aes-256-cbc";function u(i){return{ivString:i.slice(0,32),encryptedDataString:i.slice(32)}}var a=class{constructor(t){o.set(this,void 0),this.encoding="hex",l(this,o,t,"f")}encryptString(t){try{let e=(0,c.randomBytes)(16),r=(0,c.createCipheriv)(h,d(this,o,"f").exposeSecret(),e),n=Buffer.concat([r.update(t,"utf-8"),r.final()]);return e.toString(this.encoding)+n.toString(this.encoding)}catch(e){throw new Error(`\`Encryption failed because of \`${e}\``)}}decryptString(t){let{encryptedDataString:e,ivString:r}=u(t);try{let n=Buffer.from(r,this.encoding),p=Buffer.from(e,this.encoding),s=(0,c.createDecipheriv)(h,d(this,o,"f").exposeSecret(),n),f=s.update(p);return Buffer.concat([f,s.final()]).toString()}catch(n){throw new Error(`\`Decryption failed because of \`${n}\``)}}};exports.EncryptionService=a;o=new WeakMap;
